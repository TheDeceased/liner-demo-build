(function(t){function e(e){for(var r,o,s=e[0],c=e[1],d=e[2],l=0,u=[];l<s.length;l++)o=s[l],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);h&&h(e);while(u.length)u.shift()();return a.push.apply(a,d||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],r=!0,s=1;s<i.length;s++){var c=i[s];0!==n[c]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=i[0]))}return t}var r={},n={app:0},a=[];function o(e){if(r[e])return r[e].exports;var i=r[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=r,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(i,r,function(e){return t[e]}.bind(null,r));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var d=0;d<s.length;d++)e(s[d]);var h=c;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},"266d":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var r=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[t._m(0),i("line-drawer",{attrs:{"canvas-height":t.canvasHeight,"canvas-width":t.canvasWidth,"meters-height":t.metersHeight,"meters-width":t.metersWidth,"cell-meters-size":t.cellSize,"space-state":t.state}}),i("div",{staticClass:"help"},[i("h1",[t._v("Текущие параметры")]),i("ul",{staticStyle:{"text-align":"left"}},[i("li",[t._v("Размер области для отисовки: "+t._s(t.canvasWidth)+" x "+t._s(t.canvasHeight)+" px")]),i("li",[t._v("Размер области под плитку: "+t._s(t.metersWidth)+" x "+t._s(t.metersHeight)+" м")]),i("li",[t._v("Размер ячейки сетки: "+t._s(t.cellSize)+" м")])])])],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"help"},[i("h1",[t._v("How to")]),i("ul",{staticStyle:{"text-align":"left"}},[i("li",[t._v("Space - переключает режим отображения направляющих")]),i("li",[t._v("клик ЛКМ по пересечению направляющих - переход в режим рисования линии (от этой точки)")]),i("li",[t._v("клик ЛКМ по пересечению направляющих в режиме рисования линий - нарисовать линию между двумя точками (до этой точки)")]),i("li",[t._v("Ctrl+клик ЛКМ по пересечению направляющих - нарисовать горизонтальную линию через пересечение направляющих")]),i("li",[t._v("Shift+клик ЛКМ по пересечению направляющих - нарисовать вертикальную линию через пересечение направляющих")]),i("li",[t._v("двойной клик ЛКМ по направляющей (не самый простой манёвр) - нарисовать линию, совпадающую с этой направляющей")])])])}],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}})},s=[],c=i("2909"),d=(i("a9e3"),i("362d")),h={getCircle:function(t,e,i){var r=new d["a"].Circle({x:t,y:e,radius:5,fill:"#509aef",stroke:"#b9eff8",strokeWidth:1});return i&&r.on("click",i),r},getLine:function(t,e,i,r){return this._getLine(t,e,i,r,"#b9eff8",3)},getRulerLine:function(t,e,i,r,n){var a=this._getLine(t,e,i,r,"#509aef");return n&&a.on("click",n),a},_getLine:function(t,e,i,r,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return new d["a"].Line({points:[t,e,i,r],stroke:n,strokeWidth:a})}},l={name:"LineDrawer",props:{msg:String,canvasWidth:Number,canvasHeight:Number,metersWidth:Number,metersHeight:Number,cellMetersSize:Number,spaceState:{type:Number,default:1,validator:function(t){return t>=0&&t<=2}}},watch:{spaceState:function(t){return this._changeRulersSate(t)}},data:function(){return{}},grid:null,gridOpacity:.4,dotField:null,computed:{},methods:{_changeRulersSate:function(t){switch(t){case 0:this.$options.grid.opacity(0),this.$options.dotField.opacity(0);break;case 1:this.$options.grid.opacity(this.$options.gridOpacity),this.$options.dotField.opacity(0);break;case 2:this.$options.grid.opacity(this.$options.gridOpacity),this.$options.dotField.opacity(1);break}},_getPixelToMeter:function(t){var e=this.canvasWidth/this.canvasHeight,i=this.metersWidth/this.metersHeight;return e>=i?Math.round(this.canvasHeight-2*t)/this.metersHeight:Math.round(this.canvasWidth-2*t)/this.metersWidth},_activateDotLayer:function(){this.$options.dotField.hide(),this.$options.selectedDotField.show()},_deactivateDotLayer:function(){this.$options.dotField.show(),this.$options.selectedDotField.hide()},_buildStrokeLayer:function(){var t=new d["a"].Layer;return t.add(new d["a"].Rect({width:this.canvasWidth,height:this.canvasHeight,stroke:"black",fill:"#1b53a7",strokeWidth:1})),t}},mounted:function(){var t=this,e=10,i=this._getPixelToMeter(e),r=this.metersWidth*i,n=this.metersHeight*i,a=this.cellMetersSize*i,o=Math.floor((this.canvasWidth-2*e-r)/2)+e,s=Math.floor((this.canvasHeight-2*e-n)/2)+e;this.$options.grid=new d["a"].Layer({opacity:this.$options.gridOpacity,x:o,y:s});for(var l=this.$options.dotField=new d["a"].Layer({opacity:0,x:o,y:s}),u=this.$options.selectedDotField=new d["a"].Layer({x:o,y:s,clearBeforeDraw:!0,visible:!1}),f=this.$options.drawnLines=new d["a"].Layer({x:o,y:s}),p=Math.floor(this.metersWidth/this.cellMetersSize),v=Math.floor(this.metersHeight/this.cellMetersSize),g=function(t,e,i,r){f.add(h.getLine(t,e,i,r))},y=function(t,e){g(t.x(),t.y(),e.x(),e.y()),u.hide(),l.show()},m=function(e,i,r,n){t.$options.grid.add(h.getRulerLine(e,i,r,n,(function(t){(t.evt.ctrlKey||t.evt.shiftKey)&&g.apply(void 0,Object(c["a"])(t.target.attrs.points))})))},_=function(e,i){var o=t;l.add(h.getCircle(e,i,(function(t){var e=t.target;if(t.evt.ctrlKey&&g(0,e.y(),r,e.y()),t.evt.shiftKey&&g(e.x(),0,e.x(),n),!t.evt.ctrlKey&&!t.evt.shiftKey){u.destroyChildren();for(var i=0;i<=v;i++)u.add(h.getCircle(t.target.x(),i*a,(function(t){return y(e,t.target)})));u.add(h.getCircle(t.target.x(),n,(function(t){return y(e,t.target)})));for(var s=0;s<=p;s++)u.add(h.getCircle(s*a,t.target.y(),(function(t){return y(e,t.target)})));u.add(h.getCircle(r,t.target.y(),(function(t){return y(e,t.target)}))),u.add(h.getCircle(t.target.x(),t.target.y(),(function(){return o._deactivateDotLayer()}))),o._activateDotLayer()}})))},b=function(t){for(var e=0;e<=v;e++)_(t,e*a);_(t,n)},w=0;w<=p;w++)m(w*a,n,w*a,0),b(w*a);m(r,0,r,n),b(r);for(var x=0;x<=v;x++)m(r,x*a,0,x*a);m(0,n,r,n);var S=new d["a"].Stage({container:"container",width:this.canvasWidth,height:this.canvasHeight});S.add(this._buildStrokeLayer()),S.add(this.$options.grid),S.add(f),S.add(l),S.add(u)}},u=l,f=(i("edbd"),i("2877")),p=Object(f["a"])(u,o,s,!1,null,"63f65821",null),v=p.exports,g={name:"App",components:{LineDrawer:v},data:function(){return{state:1,canvasHeight:400,canvasWidth:600,metersWidth:3.1,metersHeight:2,cellSize:.15}},methods:{changeState:function(){var t=this.state;t++,this.state=t<=2?t:0}},mounted:function(){var t=this;document.onkeypress=function(e){var i=e.code||e.button;"Space"===i&&t.changeState()}}},y=g,m=(i("034f"),Object(f["a"])(y,n,a,!1,null,null,null)),_=m.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(_)}}).$mount("#app")},"85ec":function(t,e,i){},edbd:function(t,e,i){"use strict";i("266d")}});
//# sourceMappingURL=app.80fcd8cd.js.map